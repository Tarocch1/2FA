import{a as e,d as t,b as n,u as a,r,R as l,C as o,c,T as s,P as i,o as m,e as u,I as d,f as p,L as y,B as f,M as E,g,h,l as w,i as v}from"./vendor.bce97860.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,l)=>{const o=new URL(e,a);if(self[t].moduleMap[o])return n(self[t].moduleMap[o]);const c=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),s=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(c),onerror(){l(new Error(`Failed to import: ${e}`)),r(s)},onload(){n(self[t].moduleMap[o]),r(s)}});document.head.appendChild(s)})),self[t].moduleMap={}}}("/assets/");const k="/key",b=()=>e({method:"get",baseURL:"https://mfa.api.tarocch1.com",url:k}).then((e=>e.data)).catch((e=>({erred:!0,error:e}))),S=t({state:{keys:[],loading:!0},action:{getKeys:()=>async({setState:e})=>{const t=await b();t.erred?n.error("获取密钥失败"):e({keys:t}),e({loading:!1})}}});var R=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",keyStore:S});let j=0;function x(){const[e,t]=a("keyStore"),[d,p]=r.useState([]),[y,f]=r.useState(30),E=()=>{const e=m.authenticator.timeRemaining();f(e),30===e&&g()},g=()=>{const t=[];e.keys.forEach((e=>{t.push({name:e.name,token:m.authenticator.generate(e.key)})})),p(t)};r.useEffect((()=>((async()=>{await t.getKeys(),g(),E(),j=window.setInterval(E,1e3)})(),()=>{window.clearInterval(j)})),[]);const h=[{title:"Name",dataIndex:"name"},{title:"Token",dataIndex:"token",width:100,align:"center"},{key:"action",title:"Action",width:100,align:"center",render:(e,t,a)=>r.createElement("a",{onClick:()=>{return t=e.token,u(t),void n.success("复制成功");var t}},"复制")}];return r.createElement(l,{justify:"center"},r.createElement(o,{style:{maxWidth:1e3,flexGrow:1}},r.createElement(c,{bodyStyle:{padding:8},bordered:!1},r.createElement(s,{size:"middle",bordered:!0,title:()=>r.createElement(i,{percent:100*(30-y)/30,format:()=>`${y}s`}),loading:e.loading,columns:h,dataSource:d,rowKey:"name",pagination:!1}))))}let C=0;function I(){const e=r.useRef(null),[t,n]=r.useState(30),[a,c]=r.useState("000000");r.useEffect((()=>()=>{window.clearInterval(C)}),[]);const s=()=>{const e=m.authenticator.timeRemaining();n(e),30===e&&u()},u=()=>{c(m.authenticator.generate(e.current.input.value))};return r.createElement(l,{justify:"center"},r.createElement(o,{style:{marginBottom:8},span:24},r.createElement(d,{ref:e,placeholder:"key",onPressEnter:()=>{window.clearInterval(C),e.current.input.value?(u(),s(),C=window.setInterval(s,1e3)):(n(30),c("000000"))}})),r.createElement(o,{style:{marginBottom:8},span:24},r.createElement(i,{percent:100*(30-t)/30,format:()=>`${t}s`})),r.createElement(o,null,r.createElement(p.Text,{copyable:!0},a)))}function L(){const[e,t]=r.useState(!1);return r.createElement(y,null,r.createElement(y.Header,{style:{padding:"0 16px"}},r.createElement(l,{style:{height:"100%"},justify:"center",align:"middle"},r.createElement(o,{style:{maxWidth:1e3,flexGrow:1}},r.createElement(l,{justify:"space-between",align:"middle"},r.createElement(o,null,r.createElement(p.Title,{style:{color:"#fff",marginBottom:0},level:4},"MFA认证工具")),r.createElement(o,null,r.createElement(f,{type:"primary",onClick:()=>t(!0)},"计算器")))))),r.createElement(y.Content,{style:{height:"calc(100vh - 64px)",padding:16,overflowY:"auto"}},r.createElement(x,null)),r.createElement(E,{destroyOnClose:!0,maskClosable:!1,title:"计算器",footer:null,visible:e,onCancel:()=>t(!1)},r.createElement(I,null)))}g.render(r.createElement(h,{locale:w},r.createElement(v,{store:R},r.createElement(L,null))),document.querySelector("#root"));
